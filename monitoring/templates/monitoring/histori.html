{% extends 'monitoring/base.html' %}

{% block title %}Histori | Health Monitor{% endblock %}

{% block content %}
<!-- Header Card -->
<div class="histori-header-card">
    <div class="histori-header-icon">
        <i class="bi bi-clock-history"></i>
    </div>
    <div>
        <h1 class="histori-header-title">Histori Data Kesehatan</h1>
        <p class="histori-header-subtitle">Riwayat pengukuran yang telah disimpan untuk analisis kesehatan</p>
    </div>
</div>

<!-- Table Card -->
<div class="histori-table-card">
    <div class="table-responsive">
        <table class="histori-table">
            <thead>
                <tr>
                    <th>Waktu</th>
                    <th>Denyut Jantung</th>
                    <th>Suhu Tubuh</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for record in records %}
                <tr>
                    <td>
                        <span class="histori-time">{{ record.timestamp|date:"d/n/Y, H.i.s" }}</span>
                    </td>
                    <td>
                        <span class="histori-value {% if record.heart_status == 'Normal' %}hv-normal{% elif record.heart_status == 'Bradykardia' or record.heart_status == 'Takikardia' %}hv-bahaya{% else %}hv-waspada{% endif %}">
                            {{ record.heart_rate_bpm|floatformat:0 }} BPM
                        </span>
                    </td>
                    <td>
                        <span class="histori-value {% if record.temp_status == 'Normal' %}hv-normal{% elif record.temp_status == 'Hipotermia' or record.temp_status == 'Hipertermia' %}hv-bahaya{% else %}hv-waspada{% endif %}">
                            {{ record.body_temp_c|floatformat:1 }} °C
                        </span>
                    </td>
                    <td>
                        <span class="status-pill {% if record.overall_status == 'Sehat' or record.overall_status == 'Normal' %}sp-sehat{% elif record.overall_status == 'Waspada' %}sp-waspada{% else %}sp-bahaya{% endif %}">
                            {% if record.overall_status == 'Sehat' or record.overall_status == 'Normal' %}Sehat{% elif record.overall_status == 'Waspada' %}Waspada{% else %}Bahaya{% endif %}
                        </span>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4" class="text-center">
                        {% if active_device %}
                            <p class="text-muted mb-0">Belum ada data histori.</p>
                        {% else %}
                            <p class="text-muted mb-0">Belum ada perangkat aktif. Silakan pilih perangkat terlebih dahulu.</p>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <!-- Footer: Total Data -->
    <div class="histori-footer">
        Total data tersimpan: {{ records|length }} record
    </div>
</div>

<!-- Normal Values Info -->
<div class="normal-values-info">
    <span><i class="bi bi-info-circle"></i> Nilai Normal:</span>
    <span class="normal-item"><i class="bi bi-heart-pulse"></i> Denyut Jantung: <strong>60–100 BPM</strong></span>
    <span class="normal-divider">|</span>
    <span class="normal-item"><i class="bi bi-thermometer"></i> Suhu Tubuh: <strong>36,0–37,5 °C</strong></span>
</div>
{% endblock %}
